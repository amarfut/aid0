@using Microsoft.AspNetCore.Http.Features

@{
    var consentFeature = Context.Features.Get<ITrackingConsentFeature>();
    var showBanner = !consentFeature?.CanTrack ?? false;
    var cookieString = consentFeature?.CreateConsentCookie();
    var removeCookie = cookieString.Replace("yes", "no");
}



<script async src="https://www.googletagmanager.com/gtag/js?id=UA-99938281-2"></script>
<script type="text/javascript">
    var gtagId = 'UA-99938281-2';
    window['ga-disable-' + gtagId] = true;
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
</script>
<script src="https://cookiehub.net/cc/fe1f5ea9.js"></script>
<script type="text/javascript">
    window.addEventListener("load", function () {
        window.cookieconsent.initialise({
            onInitialise: function (status) {
                if (this.hasConsented('_yId')) {
                }
                if (this.hasConsented('analytics')) {
                    window['ga-disable-UA-99938281-2'] = false;
                    gtag('config', gtagId);
                }
            },
            onAllow: function (category) {
                if (category == '_yId') {
                    document.cookie = '@cookieString';
                }
                if (category == 'analytics') {
                    window['ga-disable-UA-99938281-2'] = false;
                    gtag('config', gtagId);
                }
            },
            onRevoke: function (category) {
                if (category == '_yId') {
                    document.cookie = '@removeCookie';
                    document.cookie = "_yId=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
                }
                if (category == 'analytics') {
                    window['ga-disable-UA-99938281-2'] = true;
                }
            }
        })
    });
</script>