@model Web.Controllers.ProfileViewModel
@using Web.Utils

@{Layout = "~/Views/Shared/_Layout.cshtml";}

<div class="full-post">

    @if (User.Identity.IsAuthenticated)
    {
        string c1 = Model.Action == "comments" ? "bold" : "";
        string c3 = Model.Action == "likedposts" ? "bold" : "";
        string c4 = Model.Action == "editprofile" ? "bold" : "";

        <div class="account-menu-wrapper">
            <a asp-controller="account" asp-action="profile" asp-route-param="editprofile"><div class="@c4">Профиль</div></a>
            <a asp-controller="account" asp-action="profile" asp-route-param="comments"><div class="@c1">Комментарии</div></a>
            <a asp-controller="account" asp-action="profile" asp-route-param="likedposts"><div class="@c3">Понравившееся</div></a>
        </div>

        <p>&nbsp;</p>

        <div>
            @if (Model.Action == "comments")
            {
                <div id="profile-comments">
                    <!-- ko foreach: comments -->
                    <div>
                        <a data-bind="attr: { href: $parent.getPostUrl(postUrl, commentId) }">
                            <b data-bind="text: postTitle"></b>
                        </a>
                        <p>Добавлено <span data-bind="text: createdTimeRelative"></span> </p>
                        <p data-bind="text: text"></p>

                        <button class="button-error pure-button" data-bind="click: $parent.delete">
                            Удалить комментарий
                        </button>
                    </div>
                    <!-- /ko -->
                </div>

                <script src="~/js/profile.js" async></script>
            }
            else if (Model.Action == "likedposts")
            {
                foreach (var post in Model.Posts)
                {
                    string imagePath = $"https://storage.googleapis.com/youit/{post.Url}/mini.png";
                    string postUrl = "/post/" + post.Url;

                    <a href="@postUrl">
                        <img src="@imagePath" class="liked-posts-preview" />
                        <b>@post.Title</b><br />
                        @Html.Raw(post.TextPreview)
                    </a>
                    <div style="clear:both;"></div>
                }
            }
            else if (Model.Action == "editprofile")
            {
                <div id="profile-view" style="position:relative;">
                    <form class="pure-form" action="save-profile">
                        <fieldset>
                            <legend>Ваши данные</legend>
                            <p>
                                <input type="text" name="userName" placeholder="@User.Identity.Name" />
                            </p>

                            <p>
                                <button type="submit" class="pure-button pure-button-active">Сохранить</button>
                            </p>
                        </fieldset>
                    </form>
                    <div id="photoBox">
                        <img id="userPhoto" src="@Model.UserPhoto" />
                    </div>
                </div>
            }
        </div>
    }
</div>